#!/bin/bash
usage() {
	echo "Usage: $0 somedomain.com [container name]"
}
if [ -z $1 ]; then usage; exit 1; fi
domain=$1
container_name=$2
vdomains=$(docker inspect -f '{{ .HostConfig.Binds }}' $container_name | sed 's/ /\n/g' | grep /config | awk -F: '{print $1}');
if ! grep -q "$domain" $vdomains/virtual_domains; then
	echo -n "Adding domain $domain to virtual domain configuration file ($vdomains/virtual_domains).."
	echo "$domain" >> $vdomains/virtual_domains
	echo "done."
	echo "Restart Docker container to reload configuration changes."
else
	echo "Domain $domain already exists in the virtual domain configuration file. Maybe you need to restart the Docker container?"
fi
